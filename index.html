<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>人数換算：調味料</title>

<style>
:root { --w: 560px; }
body {
  font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
  margin: 18px; line-height: 1.6;
}
h1 { font-size: 20px; margin-bottom: 12px; }

.card {
  max-width: var(--w);
  border: 1px solid #ddd;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 14px;
}

.row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.row3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

label { font-weight: 650; display: block; margin-bottom: 6px; }

input[type="number"], select {
  font-size: 16px;
  padding: 8px;
  border-radius: 10px;
  border: 1px solid #ccc;
  box-sizing: border-box;
}

.number-control {
  display: flex;
  align-items: center;
  gap: 6px;
}
.number-control input {
  width: 70px;     /* コンパクト */
  text-align: right;
}
.number-control span.unit {
  margin-left: 4px;
  white-space: nowrap;
}
.number-control button {
  width: 34px;
  height: 34px;
  font-size: 18px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: #f5f5f5;
}
.number-control button:active {
  transform: translateY(1px);
}

.muted { font-size: 12.5px; color: #666; }
.hr { height: 1px; background: #eee; margin: 12px 0; }

.result b { font-size: 24px; }
.mono { font-variant-numeric: tabular-nums; }

@media (max-width:520px){
  .row, .row3 { grid-template-columns: 1fr; }
}
</style>
</head>

<body>
<h1>人数換算：調味料</h1>

<div class="card">
  <div class="row">
    <div>
      <label>レシピは何人分？</label>
      <div class="number-control">
        <button type="button" onclick="stepPeople('recipeServings',-1)">−</button>
        <input id="recipeServings" type="number" min="1" step="1" value="1" inputmode="numeric">
        <button type="button" onclick="stepPeople('recipeServings',1)">＋</button>
        <span class="unit">人分</span>
      </div>
    </div>

    <div>
      <label>作りたいのは何人分？</label>
      <div class="number-control">
        <button type="button" onclick="stepPeople('targetServings',-1)">−</button>
        <input id="targetServings" type="number" min="1" step="1" value="1" inputmode="numeric">
        <button type="button" onclick="stepPeople('targetServings',1)">＋</button>
        <span class="unit">人分</span>
      </div>
    </div>
  </div>
  <div class="muted" style="margin-top:8px;">
    ※ 人数は最低1（0やマイナスになりません）
  </div>
</div>

<div class="card">
  <label>調味料</label>
  <select id="condiment"></select>

  <div class="hr"></div>

  <div class="row3">
    <div>
      <label>大さじ</label>
      <div class="number-control">
        <button type="button" onclick="stepMeasure('tbsp',-0.5)">−</button>
        <input id="tbsp" type="number" step="0.5" value="0" inputmode="decimal">
        <button type="button" onclick="stepMeasure('tbsp',0.5)">＋</button>
        <span class="unit">杯</span>
      </div>
    </div>

    <div>
      <label>大さじ1/2</label>
      <div class="number-control">
        <button type="button" onclick="stepMeasure('tbspHalf',-1)">−</button>
        <input id="tbspHalf" type="number" step="1" value="0" inputmode="numeric">
        <button type="button" onclick="stepMeasure('tbspHalf',1)">＋</button>
        <span class="unit">杯</span>
      </div>
    </div>
  </div>

  <div class="row3" style="margin-top:10px;">
    <div>
      <label>小さじ</label>
      <div class="number-control">
        <button type="button" onclick="stepMeasure('tsp',-1)">−</button>
        <input id="tsp" type="number" step="1" value="0" inputmode="numeric">
        <button type="button" onclick="stepMeasure('tsp',1)">＋</button>
        <span class="unit">杯</span>
      </div>
    </div>

    <div>
      <label>小さじ1/2</label>
      <div class="number-control">
        <button type="button" onclick="stepMeasure('tspHalf',-1)">−</button>
        <input id="tspHalf" type="number" step="1" value="0" inputmode="numeric">
        <button type="button" onclick="stepMeasure('tspHalf',1)">＋</button>
        <span class="unit">杯</span>
      </div>
    </div>

    <div>
      <label>小さじ1/4</label>
      <div class="number-control">
        <button type="button" onclick="stepMeasure('tspQuarter',-1)">−</button>
        <input id="tspQuarter" type="number" step="1" value="0" inputmode="numeric">
        <button type="button" onclick="stepMeasure('tspQuarter',1)">＋</button>
        <span class="unit">杯</span>
      </div>
    </div>
  </div>

  <div class="hr"></div>

  <div class="result mono">
    <div>大さじ：<b id="outTbsp">0</b> 杯</div>
    <div>小さじ：<b id="outTsp">0</b> 杯</div>
    <div>容量：<b id="outCc">0</b> cc</div>
    <div>重さ：約 <b id="outG">0</b> g</div>
  </div>
</div>

<script>
const DENSITY = {
  "水":100,"しょうゆ":120,"調理酒":100,"みりん":120,"砂糖":65,"ケチャップ":140,"ソース":120
};
const CC = { tbsp:15, tbspHalf:7.5, tsp:5, tspHalf:2.5, tspQuarter:1.25 };
const $ = id => document.getElementById(id);

Object.keys(DENSITY).forEach(k=>{
  const o=document.createElement("option");
  o.value=k; o.textContent=k;
  $("condiment").appendChild(o);
});

function toNum(v){
  const n = Number(v);
  return Number.isFinite(n) ? n : 0;
}

function clampMin1(id){
  const el = $(id);
  const v = Math.floor(toNum(el.value));
  el.value = Math.max(1, v);
}

function clampMin0(id){
  const el = $(id);
  const v = toNum(el.value);
  el.value = Math.max(0, v);
}

function stepPeople(id, delta){
  const el = $(id);
  const now = Math.floor(toNum(el.value));
  el.value = Math.max(1, now + delta);
  calc();
}

function stepMeasure(id, delta){
  const el = $(id);
  const now = toNum(el.value);
  const next = Math.max(0, now + delta);

  // 大さじだけ 0.5 刻みを維持（誤差対策で丸め）
  if (id === "tbsp") {
    el.value = Math.round(next * 2) / 2;
  } else {
    // それ以外は整数運用（小さじは整数化、1/2・1/4もカウントは整数）
    el.value = Math.round(next);
  }
  calc();
}

function round1(n){ return Math.round(n*10)/10; }

function calc(){
  // 人数は必ず 1以上
  clampMin1("recipeServings");
  clampMin1("targetServings");

  // 分量は 0以上
  ["tbsp","tbspHalf","tsp","tspHalf","tspQuarter"].forEach(clampMin0);

  const factor = toNum($("targetServings").value) / toNum($("recipeServings").value);

  const cc =
    toNum($("tbsp").value)      * CC.tbsp +
    toNum($("tbspHalf").value)  * CC.tbspHalf +
    toNum($("tsp").value)       * CC.tsp +
    toNum($("tspHalf").value)   * CC.tspHalf +
    toNum($("tspQuarter").value)* CC.tspQuarter;

  const total = cc * factor;

  $("outTbsp").textContent = round1(total/15);
  $("outTsp").textContent  = round1(total/5);
  $("outCc").textContent   = round1(total);
  $("outG").textContent    = round1(total * DENSITY[$("condiment").value] / 100);
}

document.querySelectorAll("input,select").forEach(e=>e.addEventListener("input",calc));
$("condiment").value="水";
calc();
</script>
</body>
</html>
